# ğŸš€ Zip File Manager - server ğŸš€

The project is generated by [LoopBack](http://loopback.io).

# Description ğŸ“

ZipFileManager it's a server side application which expose an REST API - POST method and accepts multiple files upload, archives those in ZIP format, saves all archives for all users in Cloud Object Storage and returns as API response the archive as a downloadble file.

# API Features 

âœ…  Upload multiple files for different users\
âœ…  Archive multiple file in ZIP format\
âœ…  Provide ZIP archive to users as a downloadble file\
âœ…  Max size for each uploded file 250MB\
âœ…  Max size for all uploaded files 800MB\
âœ…  Retain history of all created Zip archives in IBM Cloud Object Storage\

# Installation ğŸ”Œ

(credentials and sensitive data will be received in a separate file)

1. Install npm dependencies
```
npm install
```

2. Create .env file in the root folder with the following env vars:

```
DEBUG=server:*
MAX_FILE_SIZE=262144000
MAX_ARCHIVE_SIZE=838860800
ARCHIVES_BUCKET_NAME=
COS_ENDPOINT=
COS_IBMAUTHENDPOINT=
```

3. Create local-vcap.json in the root folder with the following content:

```
{
    "services": {
        "cloud-object-storage":[
            {
                "credentials": {
                    "apikey": "",
                    "endpoints": "",
                    "iam_apikey_description": "",
                    "iam_apikey_name": "cai-zip-archives",
                    "iam_role_crn": "",
                    "iam_serviceid_crn": "",
                    "resource_instance_id": ""
                }
            }
        ]
    }
}
```

# Run the app ğŸ
The Application runs using 3000 port. If you want to change it, open server/config.json file. 

In order to start the app run the following command:

```
npm run start || node .
```
or if nodemon installed

```
nodemon
```
â„¹ï¸ **Postman collection**  attached in root/docs with example of calling API.

# Tests ğŸ§ª

* API tests
* Unit test 

In order to run the test:

```
npm run test
```

In order to run eslint:

```
npm run lint
```
# Error handling âŒ

The application has a middleware for error parsing and will throw the following erros if any:
* 400 Bad Request - for calling the API without files and userName
* 403 Forbidden - for trying to upload files that are over the size limit
* 500 Internal Server Error


# Built With ğŸ”¦

* NodeJS
* Loopback 3
* Cloud Object Storage
* Archiver
* MultiParty

As well as other npm packages like: dotenv, cfenv, debug, ibm-cos-sdk, moment, chai, mocha, supertest, etc;

# Ideas of future ğŸ™Œ

ğŸ‘Œ  **Nice To Have**  Expire created Zip files after a specific period of time.

 I think will fit the current implementation to use Cloud Functions, creating triggers that will execute an action/function so that after 30 days of archive creation date can detele the archive from the Cloud Object Storage. 

ğŸ‘Œ  Add more unit tests

# Authors ğŸ‘£

Mihaela-Cristina LUNGU 


